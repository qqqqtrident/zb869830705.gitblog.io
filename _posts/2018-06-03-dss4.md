---
layout: post
author: Robin
title: 简明数据科学 第4部分：简单线性回归模型
tags: [数据科学]
categories:
  - 数据科学 
--- 

_原文地址：https://towardsdatascience.com/data-science-simplified-simple-linear-regression-models-3a97811a6a3d_

在此系列之前的文章中，已经讨论了关于统计学习的关键概念和假设验证相关内容。在本篇内容中，将进入线性回归模型的讨论。

在开始之前，回顾一下之前统计学习中比较重要的几个关键点：

**自变量和因变量：**

在统计学习的背景下，有两种类型的数据：

* 自变量：可以直接控制的数据。
* 因变量：无法直接控制的数据。

无法控制的数据，即因变量需要预测或估计。

**模型：**

**模型本质上就是一个转换引擎**，主要的作用就是找到自变量和因变量之间的关系函数。

**参数：**

参数是添加到模型中用于估计输出的一部分。

## 基本概念

线性回归模型提供了一个监督学习的简单方法。它们简单而有效。

但是，到底什么是**线性**？

线性意味着：数据点排列在或者沿着一条直线或者接近直线的线排列。线性表明，因变量和自变量之间的关系可以用直接表示。

回顾高中时的数学课程，一条直线的方程式是什么呢？

**y = mx + c**

线性回归只不过是这个简单方程的表现。

上述公式中：
* **y**是因变量，是需要估计或者预测的变量
* **x**是自变量，是可控的变量，在这里属于输入变量
* **m**是斜率，体现了直线的倾斜程度，一般使用符号*β*表示
* **c**是截距，当x为0时，确定y值的一个常数

线性回归模型并不是完美的，它试图以直接来逼近自变量和因变量之间的关系。而近似总会导致错误，并且一些错误是无法避免的，是问题性质本身所固有的，这些错误无法消除，称之为**不可简化的错误**，真正的关系中，总是具有一定的噪声项，并且是任何模型无法减少的。

上述直接公式因此可以重写为：

![](/assets/simple_data_science/4/equation-of-a-line.png)

* **β0和β1**是代表截距和斜率的两个未知常数。他们是参数。
* **ε**是误差项。

## 简述

下面通过一个例子来说明线性回归模型的术语和工作原理。

费尔南多是一名数据科学家，他想要买一辆车。他想估计或者预测他最终必须支付的汽车价格。正好他有一个朋友在一家汽车经销商上班，费尔南多向这位朋友咨询了各种其他汽车的价格以及汽车的一些特点，他的朋友向他提供了如下的一些信息：

![](/assets/simple_data_science/4/car-price.png)

* make: 车辆品牌
* fuelType：所使用的动力燃料
* nDoor：车门数量
* engineSize：发动机大小（马力）
* price：最终的价格

首先，费尔南多希望评估他是否可以根据发动机大小预测汽车价格。第一组分析旨在回答以下问题：

* 汽车价格与发动机大小有关吗？
* 这种关系有多强？
* 关系是线性的吗？
* 我们可以根据发动机大小预测/估算汽车价格吗？

费尔南多进行了相关分析，相关性是衡量两个变量相关的程度。它是通过称为**相关系数**的度量来衡量的，值在0和1之间。

如果相关系数是一个较大的数，例如 0.7 以上的数，则意味着随着一个变量的增加，另一个变量也会增加。也就说，相关系数体现了变量间“同向变化”情况。

费尔南多做了一些相关性的分析，绘制出了价格与发动机大小之间的关系。

他将数据集分割成了训练和测试两部分，其中75%的数据作为训练使用，剩下的作为测试来用。

他使用了一些统计性软件包构建了一个线性回归模型，该模型本身找到了汽车的价格和发动机大小间的关系，由此创建了一个线性方程。

![](/assets/simple_data_science/4/LR.png)

有了这个模型之后，就可以回答费尔南多想了解的几个问题了：

* 汽车价格与发动机大小有关吗？
* 是的，它们之间是有关系的。
* 这种关系有多强？
* 它们间的相关系数为0.872。是一种很强的关系。
* 关系是线性的吗？
* 存在一条直线可以拟合。一个良好的价格预测可以由发动机大小来决定。
* 我们可以根据发动机大小预测/估算汽车价格吗？
* 可以。

对于价格和发动机大小的关系显而易见，其实这个模型的最终表达式也很简单，如下：

**price = β0 + β1 x engine size**

## 模型构建与解释

### 模型

在上述内容中，原始数据集按照一定的比例进行了分割，产生训练集和测试集两大部分，训练集被用于学习或者找规律，最终创建模型，测试集被用于评估模型的性能。

费尔南多将数据集分割成了训练和测试两部分，其中75%的数据作为训练使用，剩下的作为测试来用。他使用了一些统计性软件包构建了一个线性回归模型，该模型本身找到了汽车的价格和发动机大小间的关系，由此创建了一个线性方程。

![](/assets/simple_data_science/4/split_data.png)

通过从训练数据集上进行学习训练，费尔南多得到了如下的一些结果：

![](/assets/simple_data_science/4/model_struct.png)

对于最终的模型来说，其估计参数值为：

* β0：-6870.1
* β1：156.9

从而得到线性方程为：

**price = -6870.1 + 156.9 x engine size**

### 解释

![](/assets/simple_data_science/4/Interpretation.png)

该模型最终提供了在特定发动机大小的情况下预测汽车平均价格的方程式，也就意味着：

**发动机的大小增加一个单位，将使得汽车的平均价格提高156.9个单位。**

## 评估

模型创建好了，但是模型的稳健性还需要评估。我们如何确定该模型能够预测令人满意的价格？这项评估分两部分完成。首先，测试模型的鲁棒性。其次，评估模型的准确性。

费尔南多首先在训练数据上评估模型，他得到了如下的统计数据：

![](/assets/simple_data_science/4/ss.png)

有很多的统计数据，当前仅关注红色框标注的部分，在假设检验章节中有过讨论，使用假设检验评估模型的稳健性。

H0 和 Ha需要被首先定义，如下：

* H0（空假设）：x 和 y 之间没有任何关系，即发动机的大小和车辆价格没有关系；
* Ha（替代假设）：x 和 y 之间存在某种关系，即发动机大小和车辆价格之间存在关系。

**β1**：β1 的值决定了价格和发动机大小之间的关系。如果 β1 = 0，则他们之间没有关系，否则存在关系。而从上述得到的参数中可知，β1 = 156.933，说明到价格和发动机大小之间存在某种关系。

**t-stat**：t-stat值是系数估计值（β1）远离零点的标准差。其值越远离零越强化价格和发动机大小间的关系，从上述参数中可以看到t-stat是21.09。

**p-value**：p值是一个概率值。它表示在空假设为真的情况下得到给定t-statistics的机会。如果p值小，例如<0.0001，这意味着这是偶然的并且没有关系的概率非常低。在这种情况下，p值很小。这意味着价格和引擎之间的关系并非偶然。

通过这些指标，可以得到的结论是：空假设完全不存在，并且接受替代假设。车辆的价格和发动机大小之间存在着稳定的关系。

这种关系已经确定，但是其精度如何呢？为了能够感受模型的准确度，一个名为R-squared或者决定系数的度量非常重要。

R平方或确定系数：为了理解这些指标，首先将其分解其组成部分。

![](/assets/simple_data_science/4/r-squared.png)

* **误差（e）**是实际y与预测y之间的差异。预测的y表示为ŷ。每个观察都会评估这个错误。这些错误也称为残差。
* 然后将所有残差值平方并相加。这个术语被称为残差平方和（RSS）。RSS越低越好。
* R-squared的另一部分方程。为了得到另一部分，首先计算实际目标的平均值，即估计汽车价格的平均值。然后计算平均值和实际值之间的差异。然后将这些差异平方并添加。它是总和的平方（TSS）。
* R-squared a.k.a决定系数计算为 1- RSS / TSS。该度量解释了模型预测的值与实际值平均值之间的差异部分。该值介于0和1之间。它越高，模型可以更好地解释方差。

![](/assets/simple_data_science/4/r-squared_demo.png)

在上面的例子中，RSS是根据三辆车的预测价格计算出来的。 RSS值是41450201.63。实际价格的平均值是11,021。 TSS计算为44,444,546。 R平方计算为6.737％。对于这三个具体数据点，该模型只能解释6.73％的变化。还不够好！！

但是，对于费尔南多的模型来说，其训练集的R平方为0.7503，即75.03％。这意味着该模型可以解释更多75％的变化。

## 结束

费尔南多现在有一个很好的模型。它在训练数据上表现令人满意。但是，有25％的数据没有得到解释。有改进的余地。如何增加更多的自变量来预测价格？当添加多于一个独立变量以预测因变量时，需要创建多变量回归模型，即多于一个变量的模型 --- 多元回归模型。









